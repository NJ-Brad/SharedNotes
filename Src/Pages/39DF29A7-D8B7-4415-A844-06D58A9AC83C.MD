[winforms - Jumplists in VB.NET Windows Form Application - Stack Overflow](https://stackoverflow.com/questions/67273131/jumplists-in-vb-net-windows-form-application "winforms - Jumplists in VB.NET Windows Form Application - Stack Overflow")

Add a reference to PresentationFramework.dll

This is where I found the file : Program Files (x86)\dotnet\shared\Microsoft.WindowsDesktop.App\8.0.2

I have also see that adding UseWPF to the project file works

```html
<Project Sdk="Microsoft.NET.Sdk">
  <PropertyGroup>
    <TargetFramework>net5.0-windows</TargetFramework>
    <UseWPF>true</UseWPF>
  </PropertyGroup>
</Project>
```

!!!>Note
More information about DPI Awareness: https://stackoverflow.com/questions/50239138/dpi-awareness-unaware-in-one-release-system-aware-in-the-other/50276714#50276714 r
!!!


Here's what I got working:

```basic
Dim a As System.Windows.Application = System.Windows.Application.Current
If a Is Nothing Then a = New System.Windows.Application

Dim currJumpList As System.Windows.Shell.JumpList = JumpList.GetJumpList(a)
If currJumpList Is Nothing Then
    currJumpList = New JumpList
    JumpList.SetJumpList(a, currJumpList)
Else
    currJumpList.JumpItems.Clear()
End If

Dim jumpTask As JumpTask

jumpTask = New JumpTask
jumpTask.Title = "This is what gets shown to the user"
jumpTask.Description = "This is what the user sees if they hover or the item"
jumpTask.ApplicationPath = "pathToYourEXE"
jumpTask.Arguments = "Your arguments"
jumpTask.CustomCategory = "The category header"
currJumpList.JumpItems.Add(jumpTask)

currJumpList.Apply()
```


Important Notes:

You'll need to add a reference to PresentationFramework.dll. If your in Visual Studio, its in the Framework section.
its really important to call the Apply() after you make changes to the JumpList.
if you are winforms, the moment you add a reference to you PresentationFramework, you'll notice the appearance of your GUI changes. This appears to be releated to DPI awareness. To fix, Go to your Project Properties --> Application --> View Windows Settings. This should bring up your app.manifest. In there, you'll see a commented section on dpiaware. Uncomment the entire section. Play with setting the value to true / false. I found that false would keep the GUI looking like it used to, while true improved the clarity of the fonts in my GUI. Either value should fix the issue though.


----
I am aiming this at WinForms applications
A WinForms application has a primary form, which is launched from the main method in program.cs
There are two types of operations that I am looking to achieve through JumpLists
1. Open a new document via the JumpList
1. Perform an action via the JumpList

### New Document
A new instance of the app will be created and the arguments will be passed to the main form.  This is the default behavior of JumpLists.

### Perform an action
A new instance of the app will be created.  If an instance of the application is already open, a message containg the argument will be sent to the existing main form.  The application will then close, without opening a new instance of the form.  This will avoid creating a second instance of the form.

### Perform an action (2)
Put the handling of the action in the constructor of the main form, prior to the creation of controls.  This puts all of the work within the main form (No changes to program.cs)

When using D-I, it is difficult to pass parameters.  In this situation the use of             Environment.GetCommandLineArgs(); should help (AND means that the main function doesn't need to be alterered)

# My Implementation


